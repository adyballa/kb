<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Constructors and Objects</title>
<script type="text/javascript">
    var CONFIG = {
        general : {
            verbose : false
        },
        Core : {
            Dbg : {
                showDevSAJAXErrors : false
            }
        },
        Lib : {
            Children : {
                verbose : false
            }
        }
    };
</script>
<script type="text/javascript" src="../main.js" data-config="CONFIG"
	data-task="example.constructors">
</script>
<!-- script type="text/javascript" src="/kb/sleep.php?milliSeconds=200" ></script -->
<script type="text/javascript">
console.log(GD.Core.Util.ucFirst("alle Dateien/Module sind erfolgreich geladen"));

(function(global, lib){
    "use strict";
    
	var d = {}, 
	dd = {};
	
	console.info(" --- Test globales Event-system und Mixin: Wir haengen uns in das Event gd:lib:test:parent:load ein --- ");
	GD.Core.Event.add(d, "gd:lib:test:parent:load", function(e){
	    e.target.log("gd:lib:test:parent:load wird durchlaufen. Gleich dir-Ausgabe fuer das gesamte Event");
	    console.dir(e);
	});
	
	d = new GD.Lib.Test.Children({verbose:true, myTest:true});
	dd = new GD.Lib.Test.Children();
	
	GD.Lib.Test.Children.staticTest();

	d.info("Check: Prueft Mixin aus DBG und verbose");
	console.info(" --- Test Children ueberschreibt Parent-methode: Children erhoeht Eigenschaft um 2, 3 parent primitive Property, Parent um 1. Erwartet wird ergebnis 3, parent 4 --- ");
	d.overwriteTest();
	console.info(" --- Test Konfiguration setzen: Verbose ist Klasse false und als Objekt fuer d true und dd. Erwartet ... --- ");
	dd.overwriteTest();
	console.info(" ... wird hier keine Ausgabe, aber hier:");
	d.log("Diese Info ist aus d und soll gedruckt werden");
	dd.log("Diese Info ist aus dd und darf nicht gedruckt werden.");
	
	console.info(" --- Test Vererbung: Children uebernimmt Methoden aus Parent. Methode wird aus parent reinkopiert. Erwartet wird Ausgabe 4. Damit haben alle 4. --- ");
	d.methodFromParent();
	
	console.info(" --- Test Private Eigenschaften: Ist private Eigenschaft _privateProperty vorhanden?"+('_privateProperty' in d)+" --- ");

	console.info(" --- Test parent Zugriff: Laesst overwriteTest-Methode von Eltern-objekt ausfuehren mit gemeinsam genutztem Zahler. Erwartet wird Ergebnis (_privateProperty:4 parent:5 shared:5) --- ")
	d.parentOverwriteTest();

	console.info(" --- Test Prototype ueberschreiben und Objekt-erzuegung: overwriteTest kann bei export-erzeugung (new GD.Lib.Test.Children()) nicht ueberschrieben werden, da kein Prototype existiert. Erwartet wird (_privateProperty:2 parent:8 shared:7). --- ");
	GD.Lib.Test.Children.prototype.overwriteTest = function(){
	    console.log("Ueberschreibung 1");
	}

	d.overwriteTest();
	
	dd = GD.Fabric("Lib", "Test", "Children", {verbose:true}).create();

	console.info(" --- Test Prototype ueberschreiben und Objekt-erzuegung: overwriteTest kann jetzt ueberschrieben werden, da mit create erzeugt (GD.Fabric(...).create()) wird. Erwartet wird Ausgabe - Ueberschreiben 1. --- ");
	dd.overwriteTest();
	GD.Lib.Test.Children.prototype.overwriteTest = function(){
	    console.log("Ueberschreibung 2");
	}

	console.info(" --- Test Prototype ueberschreiben und Objekt-erzuegung: overwriteTest wird nochmals mit Prototypen ueberschrieben. Erwartet wird Ausgabe - Ueberschreiben 2. --- ");
	dd.overwriteTest();

	console.info(" --- Test Private Eigenschaften: Bei create.Erzeugung sind alle private Eigenschaften zugaenglich. _privateProperty vorhanden?"+('_privateProperty' in dd)+" --- ");
	
	console.info(" --- Test Di: Erwartet wird eine Dirausgabe von einem Punkt der aus einem DI-Container gezogen wurde --- ");
	d.diTest(3);
}(this, this[__LIB__]))

/*
var builder = {
        inherit : function(clss){
            var res = function(){
                
            },
            creator = function(proto){
             	var __ = clss.create();
             	
             	return (function(proto){
             	    return {
             	    	_a : proto._a,
             	    	b : proto.b
             	    };
             	}(proto))
            };
            res.prototype = creator(clss.prototype);
//            res.prototype.__ = clss.create();
            return new res();
        },
        
        create : function(clss){
            var obj = this.inherit(clss), res = {};
             for(var i=0, j=clss.pub.length;i<j; i++){
                res[clss.pub[i]] = obj[clss.pub[i]].bind(obj);
            }
             return obj;
 
        }
},
test = function(){},
d, dd;

test.create = function(){
    return {
    	aa : 0,
       	reset : function(){
       	    this.aa = 0;
       	}
    }
};


test.prototype._a = function(){
	return __.aa++;
};

test.prototype.b = function(){
  	console.log(this._a());  
};


d = builder.create(test),
dd = builder.create(test);
console.log("-------------");
d.b();
dd.b();
d.b();
test.prototype.a = function(){
    return this.__.aa--;
};
dd.b();
d.b();
dd.b();

d.a();

(function(di){
    
}(this[__LIB__].Di))
/*
*/
</script>
</head>
<body>

</body>
</html>